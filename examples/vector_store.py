#!/usr/bin/env python
from langchain_community.vectorstores.pgvector import PGVector
from langchain_openai import OpenAIEmbeddings
from langchain_text_splitters import RecursiveCharacterTextSplitter
from langchain.docstore.document import Document
import os


embeddings = OpenAIEmbeddings()
vector_store = PGVector(
    collection_name=os.environ.get("POSTGRES_EMBEDDINGS_TABLE"),
    connection_string=os.environ.get("POSTGRES_CONNECTION_STRING"),
    embedding_function=embeddings,
    use_jsonb=True
)

# text_splitter = RecursiveCharacterTextSplitter(
#     chunk_size=1500,
#     chunk_overlap=20,
# )

raw_documents = [Document(page_content="FIDELITY BROKERAGE SERVICES LLC P.O. Box 28019 Albuquerque, NM 87125-8019\n\n2023 TAX REPORTING STATEMENT\n\nANTHONY DEMATTOS\n\nAccount No. Recipient ID No.\n\nZ04-654878\n\nCustomer Service:\n\n***-**-0979 Payer's Fed ID Number:\n\n800-544-6666 04-3523567\n\nANTHONY DEMATTOS 30 ROUIS RD BURLINGHAM NY 12722\n\neDelivered\n\nPayer's Name and Address: NATIONAL FINANCIAL SERVICES LLC 499 WASHINGTON BLVD JERSEY CITY, NJ 07310\n\nForm 1099-DIV *\n\n2023 Dividends and Distributions\n\nCopy B for Recipient (OMB No. 1545-0110)\n\n1a Total Ordinary Dividends ...................................................................................154.80 1b Qualified Dividends ................................................................................................7.32 2a Total Capital Gain Distributions .............................................................................0.00 2b Unrecap. Sec 1250 Gain........................................................................................0.00 2c Section 1202 Gain..................................................................................................0.00 2d Collectibles (28%) Gain..........................................................................................0.00 2e Section 897 Ordinary Dividends .......................................................................... 0.00 2f Section 897 Capital Gain .................................................................................. 0.00 3 Nondividend Distributions ......................................................................................0.00 4 Federal Income Tax Withheld .............................................................................0.00 5 Section 199A Dividends .........................................................................................0.00\n\n6 Investment Expenses ......................................................................................... 0.00 7 Foreign Tax Paid....................................................................................................0.00 8 Foreign Country or U.S. Possession............................................................................. 9 Cash Liquidation Distributions................................................................................0.00 10 Non-Cash Liquidation Distributions........................................................................0.00 12 Exempt Interest Dividends .....................................................................................0.00 13 Specified Private Activity Bond Interest Dividends.................................................0.00 14 State.............................................................................................................................. 15 State Identification No. .................................................................................................. 16 State Tax Withheld.................................................................................................0.00\n\nForm 1099-INT *\n\n2023 Interest Income\n\nCopy B for Recipient (OMB No. 1545-0112)\n\n1 Interest Income ................................................................................................... 0.00 2 Early Withdrawal Penalty .................................................................................... 0.00 3 Interest on U.S. Savings Bonds and Treas. Obligations ..................................... 0.00 4 Federal Income Tax Withheld .......................................................................... 0.00 5 Investment Expenses .......................................................................................... 0.00 6 Foreign Tax Paid ................................................................................................. 0.00 7 Foreign Country or U.S. Possession .................................................................... ...... 8 Tax-Exempt Interest ............................................................................................ 0.00 .............................................................. 0.00 9 Specified Private Activity Bond Interest\n\n.................................................................................................. 0.00 10 Market Discount 11 Bond Premium .................................................................................................... 0.00 12 Bond Premium on U.S. Treasury Obligations ..................................................... 0.00 13 Bond Premium on Tax-Exempt Bond .................................................................. 0.00 14 Tax-Exempt Bond CUSIP no. ........................................................................... ......... 15 State .......................................................................................................................... . 16 State Identification No ............................................................................................... . 17 State Tax Withheld .............................................................................................. 0.00\n\nThis is important tax information and is being furnished to the Internal Revenue Service. If you are required to file a return, a negligence penalty or other sanction may be imposed on you if this income is taxable and the IRS determines that it has not been reported.\n\n01/15/2024 9001000000\n\nPages 1 of 4\n\n1099-BamountsarereportedindividuallytotheIRS.RefertotheForm1099-Bsectionsinthisstatement,ifapplicable.Thedisallowedlossisincludedinthecostbasis;therefore,itiscalculatedintotherealizedgain/loss.\n\n2023 TAX REPORTING STATEMENT\n\nCustomer Service:\n\nZ04-654878\n\nANTHONY DEMATTOS\n\nAccount No. Recipient ID No.\n\n800-544-6666 04-3523567\n\n***-**-0979 Payer's Fed ID Number:\n\nForm 1099-MISC *\n\n2023 Miscellaneous Information\n\nCopy B for Recipient (OMB No. 1545-0115)\n\n2 Royalties .............................................................................................................. 0.00 3 Other Income ....................................................................................................... 0.00 4 Federal Income Tax Withheld ........................................................................... 0.00 .......................................... 0.00 8 Substitute Payments in Lieu of Dividends or Interest\n\n16 State Tax Withheld ............................................................................................... 0.00 .............................................................................................. . 17 State/Payerâ€™s State No. 18 State Income ........................................................................................................ 0.00\n\nSummary of 2023 Proceeds From Broker and Barter Exchange Transactions\n\nFederal Income Tax Withheld\n\nTotal Cost Basis\n\nTotal Proceeds\n\nTotal Wash Sales\n\n1099-B Section\n\nTotal Market Discount\n\nRealized Gain/Loss\n\n0.00\n\n0.00\n\n0.00\n\n0.00\n\n0.00\n\nShort-term transactions for which basis is reported to the IRS\n\n0.00\n\n0.00\n\n0.00\n\n0.00\n\n0.00\n\n0.00\n\n0.00\n\nShort-term transactions for which basis is not reported to the IRS\n\n0.00\n\n0.00\n\n0.00\n\nLong-term transactions for which basis is reported to the IRS\n\n0.00\n\n0.00\n\n0.00\n\n0.00\n\n0.00\n\n0.00\n\n0.00\n\n0.00\n\n0.00\n\nLong-term transactions for which basis is not reported to the IRS\n\n0.00\n\n0.00\n\n0.00\n\n0.00\n\n0.00\n\nTransactions for which basis is not reported to the IRS and Term is Unknown\n\n0.00\n\n0.00\n\n0.00\n\n0.00\n\n0.00\n\n0.00\n\n0.00\n\nSummary of 2023 Original Issue Discount\n\nTotal Original Issue Discount .....................................................................................0.00 Total Original Issue Discount on U.S. Treasury Obligations .....................................0.00 Total Original Issue Discount on Tax-Exempt Obligations ........................................0.00\n\nTotal Original Issue Discount - REMIC ...................................................................... 0.00\n\nOriginal Issue Discount (OID) amounts are reported individually to the IRS. Refer to the Form 1099-OID pages in this statement, if applicable.\n\nThis is important tax information and is being furnished to the Internal Revenue Service. If you are required to file a return, a negligence penalty or other sanction may be imposed on you if this income is taxable and the IRS determines that it has not been reported.\n\n01/15/2024 9001000000\n\nPages 2 of 4\n\n2023 TAX REPORTING STATEMENT\n\nANTHONY DEMATTOS\n\nAccount No. Recipient ID No.\n\nZ04-654878\n\nCustomer Service:\n\n***-**-0979 Payer's Fed ID Number:\n\n800-544-6666 04-3523567\n\nSummary of 2023 Supplemental Information Not Reported to the IRS\n\nMargin Interest Paid ................................................................................................ 0.00 Tax Exempt Investment Expense ............................................................................ 0.00 Accrued Interest Paid on Purchases ....................................................................... 0.00 Proceeds Investment Expenses .............................................................................. 0.00 Severance Tax ........................................................................................................ 0.00 Administrative Expenses ......................................................................................... 0.00 Non-deductible Generic Expenses .......................................................................... 0.00 Deductible Generic Expenses ................................................................................. 0.00\n\nCurrency Realized Gain/Loss (USD) ................................................................................0.00 Actual Payment Shortfall...................................................................................................0.00 Addition to Basis ...............................................................................................................0.00 Account Fees....................................................................................................................0.00 Short Dividends.................................................................................................................0.00 Money Market Realized Gain/Loss...................................................................................0.00 Short/Long Term Realized Gain/Loss...............................................................................0.00 Mortgage Pool Statement (MBS)......................................................................................0.00\n\nThis is important tax information and is being furnished to the Internal Revenue Service. If you are required to file a return, a negligence penalty or other sanction may be imposed on you if this income is taxable and the IRS determines that it has not been reported.\n\n01/15/2024 9001000000\n\nPages 3 of 4\n\n2023 SUPPLEMENTAL INFORMATION\n\nANTHONY DEMATTOS\n\nAccount No. Recipient ID No.\n\nZ04-654878\n\nCustomer Service:\n\n***-**-0979 Payer's Fed ID Number:\n\n800-544-6666 04-3523567\n\n0\n\n0 0\n\nNote: This information is not reported to the IRS. It may assist you in tax return preparation.\n\nDetails of 1099-DIV Transactions\n\nTotal Ordinary Dividends and Distributions Detail\n\nDescription, Symbol, CUSIP\n\nDate\n\n1a Total Ordinary Dividends (includes 1b, 2e & 5)\n\nDividend Distributions\n\nShort-Term Capital Gains\n\n1b Qualified Dividends\n\n2e Section 897 Ordinary Dividends\n\n5 Section 199A Dividends\n\n12 Exempt Interest Dividends\n\n13 Specified Private Activity Bond Interest Dividends\n\n7 Foreign Tax Paid\n\nAPPLE INC, AAPL, 037833100\n\n11/16/23\n\n7.32\n\n7.32\n\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\nFIDELITY GOVERNMENT MONEY MARKET, SPAXX, 31617H102\n\n04/28/23 05/31/23 06/30/23 07/31/23 08/31/23 09/29/23 10/31/23 11/30/23 12/29/23 Subtotals\n\n7.38 24.75 37.77 5.81 12.03 39.74 3.72 1.34 14.94 147.48\n\n7.38 24.75 37.77 5.81 12.03 39.74 3.72 1.34 14.94 147.48\n\n- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\nTOTALS xxxxxx\n\n154.80\n\n147.48\n\n0.00\n\n7.32\n\n0.00\n\n0.00\n\n0.00\n\n0.00\n\n0.00\n\nxxxxxx Short-term capital gain distributions reported on monthly/quarterly account statements are included in 1a Total Ordinary Dividends on Form 1099-DIV.\n\nTo see the 2023 State Percentages of Tax-Exempt Income for Fidelity Federal Tax-Exempt Funds or the Percentage of Income from U.S. Government Securities for applicable Fidelity Funds, visit Fidelity.com/fundtaxinfo.\n\nImportant Tax Return Document Enclosed.\n\n01/15/2024 9001000000\n\nPages 4 of 4", metadata={'source': '/var/folders/g5/bwv0g1fn2kl0xtk5q5075t7m0000gn/T/tmps7anxpnk.pdf'})]
# documents = text_splitter.split_documents(raw_documents)


vector_store.add_documents(raw_documents)